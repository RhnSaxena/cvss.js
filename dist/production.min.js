var CVSS=function(e){var n={};function r(a){if(n[a])return n[a].exports;var i=n[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=n,r.d=function(e,n,a){r.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:a})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,n){if(1&n&&(e=r(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var i in e)r.d(a,i,function(n){return e[n]}.bind(null,i));return a},r.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(n,"a",n),n},r.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},r.p="",r(r.s=0)}([function(e,n,r){const a=r(1);e.exports=a},function(e,n,r){const a=r(2),{roundUp:i}=r(3);e.exports=function(e){function n(){const n=e.split("/"),r={};for(const e of n){const n=e.split(":");r[n[0]]=n[1]}return r}function r(){const e=n(),r="C"===e.S,a=b(e),c=m(a,r);if(c<=0)return 0;const u=t(e,r);return i(r?Math.min(1.08*(c+u),10):Math.min(c+u,10),1)}const b=function(e){const n=u("C"),r=u("I"),a=u("A");return 1-(1-n.metrics.find(n=>n.abbr===e.C).numerical)*(1-r.metrics.find(n=>n.abbr===e.I).numerical)*(1-a.metrics.find(n=>n.abbr===e.A).numerical)},m=function(e,n){return n?7.52*(e-.029)-3.25*Math.pow(e-.02,15):6.42*e},t=function(e,n){const r=u("AV"),a=u("AC"),i=u("PR"),b=u("UI"),m=r.metrics.find(n=>n.abbr===e.AV).numerical,t=a.metrics.find(n=>n.abbr===e.AC).numerical,c=b.metrics.find(n=>n.abbr===e.UI).numerical,o=i.metrics.find(n=>n.abbr===e.PR).numerical;return 8.22*m*t*(n?o.changed:o.unchanged)*c},c=function(e,n){const r=u("MAV"),a=u("MAC"),i=u("MPR"),b=u("MUI"),m=r.metrics.find(n=>n.abbr===e.MAV).numerical,t=a.metrics.find(n=>n.abbr===e.MAC).numerical,c=b.metrics.find(n=>n.abbr===e.MUI).numerical,o=i.metrics.find(n=>n.abbr===e.MPR).numerical;return 8.22*m*t*(n?o.changed:o.unchanged)*c},u=function(e){return a.definitions.find(n=>n.abbr===e)},o=function(){const n=a.definitions.reduce((e,n,r)=>{const a=`${n.abbr}:[${n.metrics.reduce((e,n)=>e+n.abbr,"")}]`;return 0!==r?`(${e}|${a})`:a},"");if(!new RegExp("^CVSS:3.0(/"+n+")+$").test(e))return!1;const r=a.definitions.map(e=>new RegExp(`/${e.abbr}:[${e.metrics.reduce((e,n)=>e+n.abbr,"")}]`,"g"));for(const n of r)if((e.match(n)||[]).length>1)return!1;const i=[/\/AV:[NALP]/g,/\/AC:[LH]/g,/\/PR:[NLH]/g,/\/UI:[NR]/g,/\/S:[UC]/g,/\/C:[NLH]/g,/\/I:[NLH]/g,/\/A:[NLH]/g];for(const n of i)if((e.match(n)||[]).length<1)return!1;return!0}();if(!o)throw new Error("The vector format is not valid!");return{vector:e,getScore:r,getTemporalScore:function(){const e=n(),a=r(),b=u("E"),m=u("RL"),t=u("RC"),c=b.metrics.find(n=>n.abbr===(e.E?e.E:"X")).numerical,o=m.metrics.find(n=>n.abbr===(e.RL?e.RL:"X")).numerical,l=t.metrics.find(n=>n.abbr===(e.RC?e.RC:"X")).numerical;return i(a*c*o*l,1)},getEnvironmentalScore:function(){const e=n(),r="C"===e.MS,a=function(e){const n=u("MC"),r=u("MI"),a=u("MA"),i=u("CR"),b=u("IR"),m=u("AR"),t=n.metrics.find(n=>n.abbr===e.MC).numerical,c=r.metrics.find(n=>n.abbr===e.MI).numerical,o=a.metrics.find(n=>n.abbr===e.MA).numerical,l=i.metrics.find(n=>n.abbr===e.CR).numerical,d=b.metrics.find(n=>n.abbr===e.IR).numerical,f=m.metrics.find(n=>n.abbr===e.AR).numerical;return Math.min(1-(1-t*l)*(1-c*d)*(1-o*f),.915)}(e),b=c(e,r),t=m(a,r);if(t<=0)return 0;const o=u("E"),l=u("RL"),d=u("RC"),f=o.metrics.find(n=>n.abbr===e.E),s=f?f.numerical:1,g=l.metrics.find(n=>n.abbr===e.RL),h=g?g.numerical:1,M=d.metrics.find(n=>n.abbr===e.RC),N=M?M.numerical:1;return i(r?i(Math.min(1.08*(t+b),10),1)*s*h*N:i(Math.min(t+b,10),1)*s*h*N,1)},getRating:function(){const e=r();let n="None";return n=0===e?"None":e<=3.9?"Low":e<=6.9?"Medium":e<=8.9?"High":"Critical",n},getVectorObject:n,getDetailedVectorObject:function(){return e.split("/").reduce((e,n,r)=>{const a=n.split(":"),i={...e.metrics};if(r){const n=u(a[0]),r={name:n.name,abbr:n.abbr,fullName:`${n.name} (${n.abbr})`,value:n.metrics.find(e=>e.abbr===a[1]).name,valueAbbr:a[1]};return Object.assign(e,{metrics:Object.assign(i,{[a[0].trim()]:r})})}return Object.assign(e,{[a[0].trim()]:a[1]})},{metrics:{}})},isValid:o}}},function(e){e.exports=JSON.parse('{"version":"3.0","definitions":[{"name":"Attack Vector","abbr":"AV","metrics":[{"name":"Network","abbr":"N","numerical":0.85},{"name":"Adjacent","abbr":"A","numerical":0.62},{"name":"Local","abbr":"L","numerical":0.55},{"name":"Physical","abbr":"P","numerical":0.2}]},{"name":"Attack Complexity","abbr":"AC","metrics":[{"name":"Low","abbr":"L","numerical":0.77},{"name":"High","abbr":"H","numerical":0.44}]},{"name":"Privileges Required","abbr":"PR","metrics":[{"name":"None","abbr":"N","numerical":{"changed":0.85,"unchanged":0.85}},{"name":"Low","abbr":"L","numerical":{"changed":0.68,"unchanged":0.62}},{"name":"High","abbr":"H","numerical":{"changed":0.5,"unchanged":0.27}}]},{"name":"User Interaction","abbr":"UI","metrics":[{"name":"None","abbr":"N","numerical":0.85},{"name":"Required","abbr":"R","numerical":0.62}]},{"name":"Scope","abbr":"S","metrics":[{"name":"Unchanged","abbr":"U"},{"name":"Changed","abbr":"C"}]},{"name":"Confidentiality","abbr":"C","metrics":[{"name":"None","abbr":"N","numerical":0},{"name":"Low","abbr":"L","numerical":0.22},{"name":"High","abbr":"H","numerical":0.56}]},{"name":"Integrity","abbr":"I","metrics":[{"name":"None","abbr":"N","numerical":0},{"name":"Low","abbr":"L","numerical":0.22},{"name":"High","abbr":"H","numerical":0.56}]},{"name":"Availability","abbr":"A","metrics":[{"name":"None","abbr":"N","numerical":0},{"name":"Low","abbr":"L","numerical":0.22},{"name":"High","abbr":"H","numerical":0.56}]},{"name":"Exploit Code Maturity","abbr":"E","metrics":[{"name":"Not Defined","abbr":"X","numerical":1},{"name":"High","abbr":"H","numerical":1},{"name":"Functional","abbr":"F","numerical":0.97},{"name":"Proof of Concept","abbr":"P","numerical":0.94},{"name":"Unproven","abbr":"U","numerical":0.91}]},{"name":"Remediation Level","abbr":"RL","metrics":[{"name":"Not Defined","abbr":"X","numerical":1},{"name":"Unavailable","abbr":"U","numerical":1},{"name":"Workaround","abbr":"W","numerical":0.97},{"name":"Temporary Fix","abbr":"T","numerical":0.96},{"name":"Official Fix","abbr":"O","numerical":0.95}]},{"name":"Report Confidence","abbr":"RC","metrics":[{"name":"Not Defined","abbr":"X","numerical":1},{"name":"Confirmed","abbr":"C","numerical":1},{"name":"Reasonable","abbr":"R","numerical":0.96},{"name":"Unknown","abbr":"U","numerical":0.92}]},{"name":"Confidentiality Req.","abbr":"CR","metrics":[{"name":"Not Defined","abbr":"X","numerical":1},{"name":"High","abbr":"H","numerical":1.5},{"name":"Medium","abbr":"M","numerical":1},{"name":"Low","abbr":"L","numerical":0.5}]},{"name":"Integrity Req.","abbr":"IR","metrics":[{"name":"Not Defined","abbr":"X","numerical":1},{"name":"High","abbr":"H","numerical":1.5},{"name":"Medium","abbr":"M","numerical":1},{"name":"Low","abbr":"L","numerical":0.5}]},{"name":"Availability Req.","abbr":"AR","metrics":[{"name":"Not Defined","abbr":"X","numerical":1},{"name":"High","abbr":"H","numerical":1.5},{"name":"Medium","abbr":"M","numerical":1},{"name":"Low","abbr":"L","numerical":0.5}]},{"name":"Modified Attack Vector","abbr":"MAV","metrics":[{"name":"Not Defined","abbr":"X","numerical":1},{"name":"Network","abbr":"N","numerical":0.85},{"name":"Adjacent","abbr":"A","numerical":0.62},{"name":"Local","abbr":"L","numerical":0.55},{"name":"Physical","abbr":"P","numerical":0.2}]},{"name":"Modified Attack Complexity","abbr":"MAC","metrics":[{"name":"Not Defined","abbr":"X","numerical":1},{"name":"Low","abbr":"L","numerical":0.77},{"name":"High","abbr":"H","numerical":0.44}]},{"name":"Modified Privileges Required","abbr":"MPR","metrics":[{"name":"Not Defined","abbr":"X","numerical":1},{"name":"None","abbr":"N","numerical":{"changed":0.85,"unchanged":0.85}},{"name":"Low","abbr":"L","numerical":{"changed":0.68,"unchanged":0.62}},{"name":"High","abbr":"H","numerical":{"changed":0.5,"unchanged":0.27}}]},{"name":"Modified User Interaction","abbr":"MUI","metrics":[{"name":"Not Defined","abbr":"X","numerical":1},{"name":"None","abbr":"N","numerical":0.85},{"name":"Required","abbr":"R","numerical":0.62}]},{"name":"Modified Scope","abbr":"MS","metrics":[{"name":"Not Defined","abbr":"X"},{"name":"Unchanged","abbr":"U"},{"name":"Changed","abbr":"C"}]},{"name":"Modified Confidentiality","abbr":"MC","metrics":[{"name":"Not Defined","abbr":"X","numerical":1},{"name":"None","abbr":"N","numerical":0},{"name":"Low","abbr":"L","numerical":0.22},{"name":"High","abbr":"H","numerical":0.56}]},{"name":"Modified Integrity","abbr":"MI","metrics":[{"name":"Not Defined","abbr":"X","numerical":1},{"name":"None","abbr":"N","numerical":0},{"name":"Low","abbr":"L","numerical":0.22},{"name":"High","abbr":"H","numerical":0.56}]},{"name":"Modified Availability","abbr":"MA","metrics":[{"name":"Not Defined","abbr":"X","numerical":1},{"name":"None","abbr":"N","numerical":0},{"name":"Low","abbr":"L","numerical":0.22},{"name":"High","abbr":"H","numerical":0.56}]}]}')},function(e,n){e.exports={roundUp:function(e,n){return n=Math.pow(10,n),Math.ceil(e*n)/n}}}]);